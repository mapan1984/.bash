#!/bin/bash

## 同步我的bash on windows配置

# use: up -operation [mesg]
# operation:
#           -a: add
#           -c: commit
#           -push: push
#           -pull: pull
# mesg:
#     -c mesg

# 需要同步的配置文件
config_file='.bash_profile .bashrc .bash_logout bin .gitconfig .gitignore'

# 错误提示函数
function err()
{
  echo "[$(date)]: $@" 1>&2
}

# 构造.gitignore函数
function ignore()
{
  echo "" > .gitignore
  # get_gitignore为另一个可执行文件(~/bin/get_gitignore)
  get_gitignore >> .gitignore
}


# 进行参数数量判断与获取
case $# in
  0) err 'Usage: up -operation [mesg]'; exit 1 ;;
  1) 
    operation=$1;
    mesg="";;
  2) 
    operation=$1; 
    mesg=$2;;
esac

# 构造.gitignore
ignore

# 根据operation执行操作
case $operation in
  -a*) git add ${config_file} ;;
  -c*) git commit -m "${mesg}" ;;
  -push) git push origin master ;;
  -pull) git pull origin master ;;
  *) err 'Usage: up -operation [mesg]'; exit 2 ;;
esac
